---
layout: post
title: "MS Visual Studio自动化编译"
description: ""
category:
tags: [Batch File, Auto Compile]
---
{% include JB/setup %}

###文件组成
* main.bat
* prj_name.cfg
* vsvars.bat
* build.bat
* clean.bat

__main.bat__

	:: Function: Build/Clean Visual Studio Project
	:: Author:   Dennis
	:: Date:     2012-09-18

	@echo off&setlocal enabledelayedexpansion 

	mode con lines=30 cols=100
	title Build/Clean Visual Studio project

	:: Set compile environment
	:Vars
	call vsvars.bat

	:: Get project name from config file
	set prj_name=

	FOR /f "tokens=1* delims=:" %%a IN (prj_name.cfg) DO (
		set prj_name=%%b
	)

	IF "%prj_name%"=="" (
		echo "Config project name first."
		goto End
	)

	:: Main process
	:Main
	cls
	echo.
	echo. %prj_name% project manager
	echo.
	echo. 1.Build
	echo. 2.Clean
	echo.　__________________________________________________
	echo.
	set choice=
	set /p choice=   Please type function code(exit if enter)：

	if "%choice%"=="1" goto Build
	if "%choice%"=="2" goto Clean
	if defined choice goto Main
	exit

	:Clean
	call clean.bat %prj_name%
	pause
	goto Main

	:Build
	call build.bat %prj_name%
	pause
	goto Main

	:End
	pause

__prj_name.cfg__

	project_name:scmServer

__vsvars.bat__

	@echo off

	::"%VS90COMNTOOLS%"vsvars32.bat

	:: VS2005
	if NOT "%VS80COMNTOOLS%"=="" "%VS80COMNTOOLS%"vsvars32.bat
	:: VS2008
	if NOT "%VS90COMNTOOLS%"=="" "%VS90COMNTOOLS%"vsvars32.bat
	:: VS2010
	:: VS2012

__build.bat__

	@echo off
	set prj_name=%1
	devenv.com ..\%prj_name%.vcproj /build "Release"
	::pause

__clean.bat__

	@echo off
	set prj_name=%1
	devenv.com ..\%prj_name%.vcproj /clean "Release"
	::pause
